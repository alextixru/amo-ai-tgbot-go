# Аудит сервисов Complex Create

Этот файл содержит результаты последовательного аудита папки `services/complex_create/` на соответствие `tools_schema.md` и возможностям SDK.

---

## complex.go
**Layer:** complex
**Schema actions:** create
**SDK service:** LeadsService (`core/services/leads.go`)

| Метод SDK | Реализован в сервисе | Метод сервиса | Комментарий |
|-----------|----------------------|----------------|-------------|
| AddComplex | ✅ | `CreateComplexBatch` | Батч-создание |
| AddOneComplex | ✅ | `CreateComplex` | Одиночное создание |

**Genkit Tool Handler:**
- ❌ **КРИТИЧЕСКАЯ УРЕЗАННОСТЬ**: В `app/gkit/tools/complex_create.go` маппинг данных выполняется вручную и крайне ограничен.
- AI может передать только `Name`, `Price`, `PipelineID`, `StatusID` и `ResponsibleUserID` для сделки.
- ❌ **Потеря Custom Fields**: Кастомные поля сделки полностью игнорируются при комплексном создании.
- ❌ **Потеря данных контактов/компаний**: Для контактов и компаний передается **только имя**. AI не может передать телефон, email или должность в этом запросе.
- ❌ **Нет батч-режима**: Инструмент поддерживает только одиночное создание, хотя сервис умеет пакетно.

**Статус:** ⚠️ Частично (сервис ок, инструмент сильно урезан)
**TODO:** Переписать маппинг в `complex_create.go` на использование полной модели данных или хотя бы добавить CF и основные поля контактов.

### Capabilities Coverage

**Data Richness:**
- ⚠️ SDK: `ComplexLeadResult` возвращает `ContactID` и `CompanyID`.
- ✅ Bot: Сервис возвращает результат целиком, AI может увидеть созданные ID.
- ❌ Bot: AI не может полноценно использовать комплексное создание из-за "бутылочного горлышка" в маппинге данных в инструменте.

---
